% Pandoc
% John MacFarlane
% October 30, 2006

Pandoc is a [Haskell] library for converting from one markup format
to another, and a command-line tool that uses this library. It can read
[markdown] and (subsets of) [reStructuredText], [HTML], and [LaTeX],
and it can write [markdown], [reStructuredText], [HTML], [LaTeX], [RTF],
and [S5] HTML slide shows. Pandoc's version of markdown contains some
enhancements, like footnotes and embedded LaTeX.

In contrast to existing tools for converting markdown to HTML, which
use regex substitutions, Pandoc has a modular design: it consists of a
set of readers, which parse text in a given format and produce a native
representation of the document, and a set of writers, which convert
this native representation into a target format. Thus, adding an input
or output format requires only adding a reader or writer.

[markdown]: http://daringfireball.net/projects/markdown/
[reStructuredText]: http://docutils.sourceforge.net/docs/ref/rst/introduction.html
[S5]: http://meyerweb.com/eric/tools/s5/
[HTML]:  http://www.w3.org/TR/html40/
[LaTeX]: http://www.latex-project.org/
[RTF]:  http://en.wikipedia.org/wiki/Rich_Text_Format
[Haskell]:  http://www.haskell.org/

(c) 2006 John MacFarlane (jgm at berkeley dot edu). Released under the
[GPL], version 2 or greater.  This software carries no warranty of
any kind.  (See COPYRIGHT for full copyright and warranty notices.)
Recai OktaÅŸ (roktas at debian dot org) deserves credit for the build
system, the debian package, and the robust wrapper scripts.

[GPL]: http://www.gnu.org/copyleft/gpl.html "GNU General Public License"

Requirements
============

The `pandoc` program itself does not depend on any external libraries
or programs.  The convenience programs `markdown2html`, `markdown2latex`,
`markdown2rst`, `markdown2rtf`, `markdown2s5`, `html2markdown`,
`latex2markdown`, and `rst2markdown` are implemented as symbolic links to
`pandoc`.

The wrapper script `web2markdown` requires

  - `html2markdown` (included with Pandoc)
  - a POSIX-compliant shell (installed by default on all linux and unix
    systems, including Mac OS X, and in [Cygwin] for Windows),
  - `HTML Tidy`
  - `iconv` (for character encoding conversion).  (If `iconv` is absent,
    `web2markdown` will still work, but it will treat everything as UTF-8.)

[Cygwin]:  http://www.cygwin.com/ 
[HTML Tidy]:  http://tidy.sourceforge.net/
[`iconv`]: http://www.gnu.org/software/libiconv/

The wrapper script `markdown2pdf` requires

  - `markdown2latex` (included with Pandoc)
  - a POSIX-compliant shell
  - `pdflatex`, which should be part of any [LaTeX] distribution
  - the [unicode] and [fancyvrb] LaTeX packages, which are included
    in many LaTeX distributions.  The [unicode] package allows LaTeX to
    process UTF-8 characters.  [fancyvrb] allows code blocks and verbatim
    text to be used within footnotes.  If your installation of LaTeX
    does not include these packages, you will get an error (complaining
    about missing `ucs.sty` or `fancyvrb.sty`) when you try to compile
    a LaTeX file produced by Pandoc, or when you use the `markdown2pdf`
    script (described below).  If this happens, install the [unicode] and
    [fancyvrb] packages package from [CTAN].  (Get the zip file from CTAN
    and unpack it into `~/texmf/tex/latex/`.  You may also need to run
    `mktexlsr` or `texhash` before the files can be found by TeX.)

[CTAN]: http://www.ctan.org "Comprehensive TeX Archive Network"
[unicode]: http://www.ctan.org/tex-archive/macros/latex/contrib/unicode/
[fancyvrb]: http://www.ctan.org/tex-archive/macros/latex/contrib/fancyvrb/

Using Pandoc
============

If you run `pandoc` without arguments, it will accept input from
STDIN.  If you run it with file names as arguments, it will take input
from those files.  It accepts several command-line options.  For a
list, type

	pandoc -h

The most important options specify the format of the source file and
the output.  The default reader is markdown; the default writer is
HTML.  So if you don't specify a reader or writer, `pandoc` will
convert markdown to HTML.  For example,

	pandoc hello.txt

will convert `hello.txt` from markdown to HTML.  For other conversions,
you must specify a reader and/or a writer using the `-r` and `-w`
flags.  To convert markdown to LaTeX, you would write:

	pandoc -w latex hello.txt

To convert html to markdown:

	pandoc -r html -w markdown hello.txt

Supported writers include `markdown`, `latex`, `html`, `rtf` (rich text
format), `rst` (reStructuredText), and `s5` (which produces an HTML
file that acts like powerpoint).  Supported readers include `markdown`,
`html`, `latex`, and `rst`.  Note that the `rst` reader only parses
a subset of reStructuredText syntax.  For example, it doesn't handle
tables, definition lists, option lists, or footnotes.  It handles only the
constructs expressible in unextended markdown.  But for simple documents
it should be adequate.  The `latex` and `html` readers are also limited
in what they can do.  Because the `html` reader is picky about the HTML
it parses, it is recommended that you pipe HTML through [HTML Tidy] before
sending it to `pandoc`, or use the `web2markdown` script described below.

By default, `pandoc` writes its output to STDOUT.  If you want to
write to a file, use the `-o` option or shell redirection:

    pandoc -o hello.html hello.txt

	pandoc hello.txt > hello.html

Note that you can specify multiple input files on the command line.
`pandoc` will concatenate them all (with blank lines between them)
before parsing:

	pandoc -s chapter1.txt chapter2.txt references.txt > book.html

(The `-s` option here tells `pandoc` to produce a standalone HTML file,
with a proper header, rather than a fragment.  For more details on this
and many other command-line options, see below.)

Character encodings
-------------------

Unfortunately, due to limitations in GHC, `pandoc` does not automatically
detect the system's local character encoding.  Hence, all input and
output is assumed to be in the UTF-8 encoding.  If your local character
encoding is not UTF-8 and you use accented or foreign characters,
you should pipe the input and output through [`iconv`]. For example,

	iconv -t utf-8 source.txt | pandoc | iconv -f utf-8 > output.html

will convert `source.txt` from the local encoding to UTF-8, then
convert it to HTML, then convert back to the local encoding,
putting the output in `output.html`.

The shell scripts (described below) automatically convert the input 
from the local encoding to UTF-8 before running them through `pandoc`,
then convert the output back to the local encoding.

Convenience programs and wrapper scripts 
========================================

For convenience, eight variant programs are included with Pandoc:
`markdown2html` (which is equivalent to `pandoc  -w  html`),
`markdown2latex` (equivalent to `pandoc -w latex`), `markdown2rst`
(equivalent to `pandoc -w rst`), `markdown2rtf` (equivalent to
`pandoc -w rtf`), `markdown2s5` (equivalent to `pandoc -w s5`),
`html2markdown` (equivalent to `pandoc -r html -w markdown`),
`latex2markdown` (equivalent to `pandoc -r latex -w markdown`), and
`rst2markdown` (equivalent to `pandoc -r rst -w markdown`).  These
programs take an appropriately restricted subset of `pandoc`'s
options.  (Run them with the `-h` flag for a full list of allowed
options.)

Like `pandoc`, all of these programs produce fragments by default.
If you want to produce a standalone file, complete with a header
and footer appropriate to the format, use the `-s` option:

   markdown2latex -s sample.txt > sample.tex 

Two shell scripts have also been included:

1.  `markdown2pdf` produces a PDF file from markdown-formatted
    text, using `markdown2latex` and `pdflatex`.  The default
    behavior of `markdown2pdf` is to create a file with the same
    base name as the first argument and the extension `pdf`; thus,
    for example,

	    markdown2pdf sample.txt endnotes.txt

    will produce `sample.pdf`.  (If `sample.pdf` exists already,
    it will be backed up before being overwritten.)  An output file
    name can be specified explicitly using the `-o` option:

	    markdown2pdf -o "My Book.pdf" chap1.txt chap2.txt chap3.txt  

    If no input file is specified, input will be taken from STDIN.

2.  `web2markdown` grabs a web page from a file or URL and converts
    it to markdown-formatted text, using `tidy` and `html2markdown`.
    Unless input is from STDIN, an attempt is made to determine the
    character encoding of the page from the "Content-type" meta tag.
    If this is not present, UTF-8 is assumed.  Alternatively, a character
    encoding may be specified explicitly using the `-e` option.

    `web2markdown` searches for an available program (`wget`, `curl`,
    or a text-mode browser) to fetch the contents of a URL.
    Optionally, the `-g` command may be used to specify the command
    to be used:

        web2markdown -g 'wget --user=foo --password=bar' mysite.com

Command-line options
====================

Various command-line options can be used to customize the output.
For a complete list, type 

	pandoc --help

`-p` or `--preserve-tabs` causes tabs in the source text to be
preserved, rather than converted to spaces (the default).

`--tabstop` allows the user to set the tab stop (which defaults to 4).

`-R` or `--parse-raw` causes the HTML and LaTeX readers to parse HTML
codes and LaTeX environments that it can't translate as raw HTML or
LaTeX.  Raw HTML can be printed in markdown, reStructuredText, HTML,
and S5 output; raw LaTeX can be printed in markdown, reStructuredText,
and LaTeX output.  The default is for the readers to omit
untranslatable HTML codes and LaTeX environments.  (The LaTeX reader
does pass through untranslatable LaTeX commands, even if `-R` is not
specified.)

`-s` or `--standalone` causes `pandoc` to produce a standalone file,
complete with appropriate document headers.  By default, `pandoc`
produces a fragment.

`-o` or `--output-file` can be used to specify an output file.

`-C` or `--custom-header` can be used to specify a custom document
header.  To see the headers used by default, use the `-D` option:
for example, `pandoc -D html` prints the default HTML header.

`-c` or `--css` allows the user to specify a custom stylesheet that
will be linked to in HTML and S5 output.

`-H` or `--include-in-header` specifies a file to be included
(verbatim) at the end of the document header.  This can be used, for
example, to include special CSS or javascript in HTML documents.

`-B` or `--include-before-body` specifies a file to be included
(verbatim) at the beginning of the document body (after the `<body>`
tag in HTML, or the `\begin{document}` command in LaTeX).  This can be
used to include navigation bars or banners in HTML documents.

`-A` or `--include-after-body` specifies a file to be included
(verbatim) at the end of the docment body (before the `</body>` tag in
HTML, or the `\end{document}` command in LaTeX).

`-T` or `--title-prefix` specifies a string to be included as a prefix
at the beginning of the title that appears in the HTML header (but not
in the title as it appears at the beginning of the HTML body).  (See
below on Titles.)

`-S` or `--smart` causes `pandoc` to produce typographically
correct HTML output, along the lines of John Gruber's [Smartypants].
Straight quotes are converted to curly quotes, `---` to dashes, and
`...` to ellipses.

[Smartypants]: http://daringfireball.net/projects/smartypants/

`-m` or `--asciimathml` will cause LaTeX formulas (between $ signs) in
HTML or S5 to display as formulas rather than as code.  The trick will
not work in all browsers, but it works in Firefox.  Peter Jipsen's
[ASCIIMathML] script is used to do the magic.

[ASCIIMathML]: http://www1.chapman.edu/~jipsen/mathml/asciimath.html

`-i` or `--incremental` causes all lists in S5 output to be displayed
incrementally by default (one item at a time).  The normal default
is for lists to be displayed all at once.

`-N` or `--number-sections` causes sections to be numbered in LaTeX
output.  By default, sections are not numbered.

`-d` or `--debug` causes a debugging message to be written to STDERR.
The format of the message is as follows:

    OUTPUT=foo
    INPUT=bar
    INPUT=Foo Baz

Here `OUTPUT=` is followed by the name of the output file specified
using `-o`, if any.  If no output file was specified, `OUTPUT=`
will appear with nothing following it.  Lines beginning `INPUT=`
specify input files.  If there are no input files, no `INPUT=` lines
will be printed.  The `-d` option forces output to be written to
STDOUT, even if an output file was specified using the `-o` option.
(This option is provided to make it easier to write wrappers for
`pandoc`.)

`-v` or `--version` prints the version number to STDERR.

`-h` or `--help` prints a usage message to STDERR.

Pandoc's markdown vs. standard markdown
=======================================

In parsing markdown, Pandoc departs from and extends [standard markdown]
in a few respects.  (To run Pandoc on the official
markdown test suite, type `make test-markdown`.)

[standard markdown]:  http://daringfireball.net/projects/markdown/syntax
  "Markdown syntax description"

Section Headings
----------------

Pandoc creates an invisible anchor in front of every HTML section
heading.  The ID of this anchor is derived from the section heading
itself:  spaces are converted to underscores, and formatting, links,
and other markup are removed.  Thus, for example, the source

    ## Aristotle's *De Anima*

gets converted to HTML as follows:

    <a id="Aristotle's_De_Anima"></a>
    <h2>Aristotle's <em>De Anima</em></h2>

This makes it easy to provide internal links that jump to a particular
place in a document.  To provide a link to the heading above, for
example, just insert:

    [Back to Aristotle](#Aristotle's_De_Anima)

Lists
-----

Pandoc behaves differently from standard markdown on some "edge
cases" involving lists.  Consider this source: 

	1.  First
	2.  Second:
		-   Fee
		-   Fie
		-   Foe

	3.  Third

Pandoc transforms this into a "compact list" (with no `<p>` tags
around "First", "Second", or "Third"), while markdown puts `<p>`
tags around "Second" and "Third" (but not "First"), because of
the blank space around "Third".  Pandoc follows a simple rule:
if the text is followed by a blank line, it is treated as a
paragraph.  Since "Second" is followed by a list, and not a blank
line, it isn't treated as a paragraph.  The fact that the list
is followed by a blank line is irrelevant. 

Unlike standard markdown, Pandoc allows ordered list items to be
marked with single letters, instead of numbers.  So, for example,
this source yields a nested ordered list:

    1.  First
    2.  Second
        a.  Fee
        b.  Fie
    3.  Third

Pandoc also extends standard markdown in allowing list item markers
to be terminated by ')':

    1)  First
    2)  Second
        A)  Fee
        B)  Fie
    3)  Third

Note that Pandoc pays no attention to the *type* of ordered list
item marker used.  Thus, the following is treated just the same as
the example above:

    A)  First
    1.  Second
        2.  Fee
        B)  Fie
    C)  Third

Literal quotes in titles
------------------------

Standard markdown allows unescaped literal quotes in titles, as
in 

	[foo]: "bar "embedded" baz"

Pandoc requires all quotes within titles to be escaped:

	[foo]: "bar \"embedded\" baz"

Reference links
---------------

Pandoc allows implicit reference links in either of two styles:

	1. Here's my [link]
	2. Here's my [link][]

	[link]: linky.com

If there's no corresponding reference, the implicit reference link
will appear as regular bracketed text.  Note: even `[link][]` will
appear as `[link]` if there's no reference for `link`.  If you want
`[link][]`, use a backslash escape: `\[link]\[]`.

Footnotes
---------

Pandoc's markdown allows footnotes, using the following syntax:

	Here is a footnote reference,[^1] and another.[^longnote]

	[^1]: Here is the footnote.  It can go anywhere in the document,
	except in embedded contexts like block quotes or lists.	

	[^longnote]: Here's the other note.  This one contains multiple
	blocks.

        Subsequent paragraphs are indented to show that they belong to
    the previous footnote.

            { some.code }

	    The whole paragraph can be indented, or just the first line.
	    In this way, multi-paragraph footnotes work just like
	    multi-paragraph list items in markdown.

    This paragraph won't be part of the note.

The identifiers in footnote references may not contain spaces, tabs,
or newlines.  These identifiers are used only to correlate the
footnote reference with the note itself; in the output, footnotes
will be numbered sequentially.

Inline footnotes are also allowed (though, unlike regular notes,
they cannot contain multiple paragraphs).  The syntax is as follows:

    Here is an inline note.^[Inlines notes are easier to write, since
    you don't have to pick an identifier and move down to type the
    note.]

Inline and regular footnotes may be mixed freely.

Embedded HTML
-------------

Pandoc treats embedded HTML in markdown a bit differently than
Markdown 1.0.  While Markdown 1.0 leaves HTML blocks exactly as they
are, Pandoc treats text between HTML tags as markdown.  Thus, for
example, Pandoc will turn

	<table>
		<tr>
			<td>*one*</td>
			<td>[a link](http://google.com)</td>
		</tr>
	</table>

into

	<table>
		<tr>
			<td><em>one</em></td>
			<td><a href="http://google.com">a link</a></td>
		</tr>
	</table>

whereas Markdown 1.0 will preserve it as is.

There is one exception to this rule:  text between `<script>` and
`</script>` tags is not interpreted as markdown.

This departure from standard markdown should make it easier to mix
markdown with HTML block elements.  For example, one can surround
a block of markdown text with `<div>` tags without preventing it
from being interpreted as markdown.

Title blocks
------------

If the file begins with a title block

	% title
	% author(s) (separated by commas)
	% date

it will be parsed as bibliographic information, not regular text.  (It
will be used, for example, in the title of standalone LaTeX or HTML
output.)  The block may contain just a title, a title and an author,
or all three lines.  Each must begin with a % and fit on one line.
The title may contain standard inline formatting.  If you want to
include an author but no title, or a title and a date but no author,
you need a blank line:

	% My title
	% 
	% June 15, 2006

Titles will be written only when the `--standalone` (`-s`) option is
chosen.  In HTML output, titles will appear twice: once in the
document head -- this is the title that will appear at the top of the
window in a browser -- and once at the beginning of the document body.
The title in the document head can have an optional prefix attached
(`--title-prefix` or `-T` option).  The title in the body appears as
an H1 element with class "title", so it can be suppressed or
reformatted with CSS.

If a title prefix is specified with `-T` and no title block appears
in the document, the title prefix will be used by itself as the
HTML title.

Box-style blockquotes
---------------------

Pandoc supports emacs-style boxquote block quotes, in addition to
standard markdown (email-style) boxquotes:

	,----
	| They look like this.
	`----

Inline LaTeX
------------

Anything between two $ characters will be parsed as LaTeX math.  The
opening $ must have a character immediately to its right, while the
closing $ must have a character immediately to its left.  Thus,
`$20,000 and $30,000` won't parse as math.  The $ character can be
escaped with a backslash if needed.

If you pass the `-m` (`--asciimathml`) option to `pandoc`, it will
include the [ASCIIMathML] script in the resulting HTML.  This will
cause LaTeX math to be displayed as formulas in better browsers.

[ASCIIMathML]: http://www1.chapman.edu/~jipsen/asciimath.html 

Inline LaTeX commands will also be preserved and passed unchanged
to the LaTeX writer.  Thus, for example, you can use LaTeX to
include BibTeX citations:

	This result was proved in \cite{jones.1967}.

You can also use LaTeX environments.  For example,

	\begin{tabular}{|l|l|}\hline
	Age & Frequency \\ \hline
	18--25  & 15 \\
	26--35  & 33 \\ 
	36--45  & 22 \\ \hline
	\end{tabular}

Note, however, that material between the begin and end tags will
be interpreted as raw LaTeX, not as markdown.

Custom headers
--------------

When run with the "standalone" option (`-s`), `pandoc` creates a
standalone file, complete with an appropriate header.  To see the
default headers used for html and latex, use the following commands:

	pandoc -D html

	pandoc -D latex 

If you want to use a different header, just create a file containing
it and specify it on the command line as follows:

	pandoc --header=MyHeaderFile

Producing S5 with Pandoc
========================

Producing an [S5] web-based slide show with Pandoc is easy.  A title
page is constructed automatically from the document's title block (see
above).  Each section (with a level-one header) produces a single slide.
(Note that if the section is too big, the slide will not fit on the page;
S5 is not smart enough to produce multiple pages.)

Here's the markdown source for a simple slide show, `eating.txt`:

	% Eating Habits
	% John Doe
	% March 22, 2005

	# In the morning

	- Eat eggs
	- Drink coffee

	# In the evening

	- Eat spaghetti
	- Drink wine

To produce the slide show, simply type

	pandoc -w s5 -s eating.txt > eating.html

and open up `eating.html` in a browser.  The HTML file embeds
all the required javascript and CSS, so no other files are necessary.

Note that by default, the S5 writer produces lists that display
"all at once."  If you want your lists to display incrementally
(one item at a time), use the `-i` option.  If you want a
particular list to depart from the default (that is, to display
incrementally without the `-i` option and all at once with the
`-i` option), put it in a block quote:

	> - Eat spaghetti
	> - Drink wine

In this way incremental and nonincremental lists can be mixed in
a single document.

